<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- w3-css loading -->

		<title>CSTB - Crispr Search Tool for Bacteria</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!--
		<script type="text/javascript">
  			var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
		</script>
		-->

		<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">

		<!-- Code for fetching jquery and jstree online [requires internet connection]-->
		<!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> -->
		<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.1.1.js"></script> <!-- backup -->
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
			<script src="/socket.io/socket.io.js"></script>
		      <script>
		      		var socket = io.connect('http://localhost:8888')

            	socket.on('connect', function() {
									console.log('connected');
                	socket.emit('clientConnection', {data: 'I\'m connected!'});
									displayTreeIn('')
									displayTreeNotIn('')
						});


						function displayTreeIn(suffix){

							var to = false;
							$('#search_in'+suffix).keyup(function () {
								if(to) { clearTimeout(to); }
								to = setTimeout(function () {
									var v = $('#search_in'+suffix).val();
									$('#tree_include'+suffix).jstree().search(v);
								}, 250);
							});
							$.jstree.defaults.search.show_only_matches=true;
							// tree building

							$('#tree_include'+suffix).jstree({
								"core" : {
									'data' : { "url" : "./jsontree.json", "dataType" : "json"},
									'themes' : [
										{"dots" : true}
									],
									'animation' : false
								},
								"checkbox" : {
									"keep_selected_style" : false
								},
								"plugins" : [ "wholerow" , "checkbox" , "search" , "dnd" , "types"]
							});
							$('#tree_include'+suffix).jstree().show_dots();
						}

						function displayTreeNotIn(suffix){

							var to = false;
							$('#search_notin'+suffix).keyup(function () {
								if(to) { clearTimeout(to); }
								to = setTimeout(function () {
									var v = $('#search_notin'+suffix).val();
									$('#tree_exclude'+suffix).jstree().search(v);
								}, 250);
							});
							$.jstree.defaults.search.show_only_matches=true;
							// tree building

							$('#tree_exclude'+suffix).jstree({
								"core" : {
									'data' : { "url" : "./jsontree.json", "dataType" : "json"},
									'themes' : [
										{"dots" : true}
									],
									'animation' : false
								},
								"checkbox" : {
									"keep_selected_style" : false
								},
								"plugins" : [ "wholerow" , "checkbox" , "search" , "dnd" , "types"]
							});
							$('#tree_exclude'+suffix).jstree().show_dots();
						}

        	</script>

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/jstree.min.js"></script>
		<!-- <script src="./responsive.js"></script> -->

		<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/themes/default/style.min.css">

		<!-- modif begin -->
		<link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One|Permanent+Marker" rel="stylesheet">
		<!-- modif end-->

	</head>

	<!-- BEGIN TREE -->
	<div id='tree_ag' class="w3-container w3-border w3-margin-bottom w3-padding-bottom">

		<div class="w3-half">
			<h3 class="w3-container w3-red"><i>Organisms to target</i></h3>
			<input classe="w3-input w3-margin-left w3-margin-right" style="max-width:600px" id="search_in" type="text" value="" placeholder="Search for an organism" />
			<div id="wrap">
				<div id="tree_include" class="w3-container w3-hover-pale-red">
				</div>
			</div>
		</div>

		<div class="w3-half">
			<h3 class="w3-container w3-green"><i>Organisms to exclude</i></h3>
			<input classe="w3-input w3-margin-left w3-margin-right" style="max-width:600px" id="search_notin" type="text" value="" placeholder="Search for an organism" />
			<div id="wrap">
				<div id="tree_exclude" class="w3-container w3-hover-pale-green">
				<!-- Here will display the tree -->
				</div>
			</div>
		</div>
		<button id="submit_trees" class="w3-btn w3-ripple w3-green w3-right"><b>Submit selections</b></button>
		<button id="reset_trees" class="w3-btn w3-ripple w3-red w3-left">Reset trees</button>
	</div>
	<!-- END TREE -->
